# Задание 5.## Беловицкий Владислав БПИ198## Задача 1.```readers ( number, last_name, first_name, birth_date, address)books ( isbn, title, year, page_count, publisher_name)publishers ( name, adress)categories ( name, parent_name)copies ( number, isbn, position)bookings ( reader_number, copy_number, isbn, return_date)book_categories ( isbn, category_name )```### 1. Показать все названия книг вместе с именами издателей.``` sqlSELECT title, publisher_name FROM books```### 2. В какой книге наибольшее количество страниц?``` sqlSELECT isbn, title, page_countFROM booksWHERE page_count = (SELECT MAX(page_count) from books)```### 3. Какие авторы написали более 5 книг?``` sqlSELECT authorFROM booksGROUP BY authorHAVING COUNT(*) > 5```### 4. В каких книгах более чем в два раза больше страниц, чем среднее количество страниц для всех книг?``` sqlSELECT isbn, titleFROM booksWHERE page_count > (SELECT AVG(page_count) FROM books) * 2```### 5. Какие категории содержат подкатегории?``` sqlSELECT DISTINCT parent_nameFROM categoriesWHERE parent_name IS NOT NULL```### 6. У какого автора (предположим, что имена авторов уникальны) написано максимальное количество книг?``` sqlSELECT DISTINCT authorFROM booksWHERE author =    (SELECT author     FROM books     GROUP BY author     ORDER BY count(*) desc     LIMIT 1    )```### 7. Какие читатели забронировали все книги (не копии), написанные "Марком Твеном"?``` sqlSELECT rb.number    FROM (SELECT r.number, COUNT(*) bookings_count        FROM readers r        JOIN bookings bs on bs.reader_number = r.number        JOIN books b on b.isbn = bs.isbn        WHERE b.author = 'Марк Твен'        GROUP BY r.number        ) rbWHERE rb.bookings_count = (    SELECT COUNT(isbn)    FROM books    WHERE author = 'Марк Твен'    )```### 8. Какие книги имеют более одной копии?``` sqlSELECT b.isbn, b.titleFROM books bJOIN copies c on c.isbn = b.isbnGROUP BY b.isbnHAVING count(*) > 1```### 9. ТОП 10 самых старых книг``` sqlSELECT isbn, title, yearFROM booksORDER BY yearLIMIT 10```### 10. Перечислите все категории в категории “Спорт” (с любым уровнем вложености).``` sqlWITH RECURSIVE sport_categories AS(  SELECT name, parent_name FROM categories WHERE name = 'Sport'  UNION ALL  SELECT sub_categories.name, sub_categories.parent_name  FROM categories sub_categories  JOIN sport_categories ON sport_categories.name = sub_categories.parent_name)SELECT sport_categories.name, sport_categories.parent_nameFROM sport_categories```